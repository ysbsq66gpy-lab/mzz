<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Îâ¥Ïä§ Í≤ÄÏÉâ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #fff; color: #202124; -webkit-font-smoothing: antialiased; }
        .home-screen { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 20px; }
        .home-screen.hidden { display: none; }
        .home-logo { font-size: 92px; font-weight: 400; margin-bottom: 30px; }
        .home-logo span:nth-child(1) { color: #4285f4; } .home-logo span:nth-child(2) { color: #ea4335; } .home-logo span:nth-child(3) { color: #fbbc04; }
        .home-logo span:nth-child(4) { color: #4285f4; } .home-logo span:nth-child(5) { color: #34a853; } .home-logo span:nth-child(6) { color: #ea4335; }
        .home-search-box, .header-search-box { display: flex; align-items: center; border: 1px solid #dadce0; border-radius: 24px; padding: 0 20px; background: #fff; }
        .home-search-box { height: 48px; width: 100%; max-width: 584px; margin-bottom: 30px; box-shadow: 0 2px 5px 1px rgba(64,60,67,.16); }
        .header-search-box { height: 40px; flex: 1; max-width: 500px; box-shadow: 0 1px 6px rgba(32,33,36,.08); }
        .header-search-box:focus-within { box-shadow: 0 1px 6px rgba(32,33,36,.28); }
        input { flex: 1; border: none; outline: none; font-size: 16px; padding: 0 10px; background: transparent; color: #202124; }
        .header-search-box input { font-size: 14px; }
        .search-clear-btn { background: none; border: none; cursor: pointer; color: #9aa0a6; font-size: 20px; padding: 0 5px; display: none; }
        .search-clear-btn:hover { color: #202124; }
        .home-search-box:has(input:not(:placeholder-shown)) .search-clear-btn,
        .header-search-box:has(input:not(:placeholder-shown)) .search-clear-btn { display: block; }
        .home-buttons { display: flex; gap: 10px; justify-content: center; }
        button { padding: 10px 24px; font-size: 14px; font-weight: 500; border: 1px solid #dadce0; border-radius: 4px; background: #f8f9fa; color: #3c4043; cursor: pointer; }
        button:active { box-shadow: 0 1px 1px rgba(0,0,0,.1); }
        .search-header { position: sticky; top: 0; background: #fff; border-bottom: 1px solid #dadce0; z-index: 100; padding: 10px 20px; display: none; }
        .search-header.visible { display: block; }
        .header-top { display: flex; align-items: center; gap: 20px; max-width: 1200px; margin: 0 auto; padding: 10px 0; }
        .header-logo { font-size: 20px; font-weight: 500; color: #4285f4; cursor: pointer; white-space: nowrap; }
        .tabs { display: none; border-top: 1px solid #dadce0; padding: 0 20px; max-width: 1200px; margin: 0 auto; }
        .tabs.visible { display: flex; gap: 30px; }
        .tab { padding: 15px 0; border-bottom: 3px solid transparent; color: #70757a; font-size: 14px; cursor: pointer; background: none; border: none; margin: 0; font-weight: 400; }
        .tab.active { color: #4285f4; border-bottom-color: #4285f4; }
        .tab:hover { color: #202124; }
        .results-wrapper { display: none; max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .results-wrapper.visible { display: block; }
        .results-layout { display: grid; grid-template-columns: 1fr; gap: 20px; padding: 20px 0; }
        .results-main { max-width: 750px; contain: layout; }
        .result-count { font-size: 13px; color: #70757a; margin-bottom: 20px; }
        .search-result { margin-bottom: 26px; display: grid; grid-template-columns: 1fr 120px; gap: 15px; align-items: start; }
        .result-content { min-width: 0; }
        .result-image { width: 120px; height: 80px; object-fit: cover; border-radius: 4px; }
        .result-url { font-size: 12px; color: #006621; margin-bottom: 2px; word-break: break-word; }
        .result-title { font-size: 20px; font-weight: 400; line-height: 1.3; margin-bottom: 8px; }
        .result-title a { color: #1f0dcc; text-decoration: none; }
        .result-title a:visited { color: #681da8; }
        .result-snippet { font-size: 14px; line-height: 1.6; color: #545454; margin-bottom: 6px; word-break: break-word; }
        .result-time { font-size: 13px; color: #70757a; display: flex; align-items: center; gap: 6px; }
        .error { background: #fff3cd; border: 1px solid #ffc107; padding: 15px; border-radius: 4px; color: #856404; margin: 20px 0; }
        .no-results, .loading { text-align: center; padding: 40px 20px; color: #70757a; }
        .no-results h2 { color: #202124; margin-bottom: 10px; font-size: 18px; }
    </style>
</head>
<body>
    <div id="home-screen" class="home-screen">
        <div class="home-logo"><span>Îâ¥</span><span>Ïä§</span><span>Í≤Ä</span><span>ÏÉâ</span></div>
        <div class="home-search-box">
            <input type="text" id="homeSearch" placeholder="Îâ¥Ïä§ Í≤ÄÏÉâ" autocomplete="off" />
            <button class="search-clear-btn" type="button" onclick="document.getElementById('homeSearch').value='';document.getElementById('homeSearch').focus();">‚úï</button>
        </div>
        <div class="home-buttons"><button type="button" onclick="performHomeSearch()">Í≤ÄÏÉâ</button></div>
    </div>
    
    <div id="search-results">
        <div id="search-header" class="search-header">
            <div class="header-top">
                <div class="header-logo" onclick="location.reload()">Îâ¥Ïä§Í≤ÄÏÉâ</div>
                <div class="header-search-box">
                    <input type="text" id="headerSearch" placeholder="Îâ¥Ïä§ Í≤ÄÏÉâ" autocomplete="off" />
                    <button class="search-clear-btn" type="button" onclick="document.getElementById('headerSearch').value='';document.getElementById('headerSearch').focus();">‚úï</button>
                </div>
            </div>
            <div id="tabs" class="tabs">
                <button class="tab active" type="button">Î™®Îì† Îâ¥Ïä§</button>
                <button class="tab" type="button">ÏµúÏã†</button>
                <button class="tab" type="button">Í¥ÄÎ†®ÎèÑÏàú</button>
            </div>
        </div>
        
        <div id="results-wrapper" class="results-wrapper">
            <div class="results-layout">
                <div id="results-main" class="results-main"></div>
            </div>
        </div>
    </div>

    <script>
        const $ = (id) => document.getElementById(id);
        const homeSearch = $('homeSearch');
        const headerSearch = $('headerSearch');
        const searchHeader = $('search-header');
        const resultsWrapper = $('results-wrapper');
        const resultsMain = $('results-main');
        const homeScreen = $('home-screen');
        
        function show() {
            homeScreen.classList.add('hidden');
            searchHeader.classList.add('visible');
            resultsWrapper.classList.add('visible');
        }
        
        function searchHome() {
            const kw = homeSearch.value.trim();
            if (!kw) return alert('Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî');
            headerSearch.value = kw;
            search(kw);
        }
        
        async function search(kw) {
            show();
            resultsMain.innerHTML = '<div class="loading"><p>Í≤ÄÏÉâ Ï§ë...</p></div>';
            try {
                const res = await fetch('/api/search_keyword', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({keyword: kw})
                });
                const data = await res.json();
                if (data.error) {
                    resultsMain.innerHTML = `<div class="error">Ïò§Î•ò: ${data.error}</div>`;
                } else if (data.results?.length) {
                    let html = `<div class="result-count">${data.results.length}Í∞úÏùò Í≤ÄÏÉâ Í≤∞Í≥º</div>`;
                    data.results.forEach(item => {
                        const url = new URL(item.link).hostname + new URL(item.link).pathname.split('/').slice(0,3).join('/');
                        const img = item.image ? `<img class="result-image" src="${item.image}" alt="Îâ¥Ïä§ Ïù¥ÎØ∏ÏßÄ" loading="lazy" />` : `<img class="result-image" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='80'%3E%3Crect fill='%23e0e0e0' width='120' height='80'/%3E%3Ctext x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-family='sans-serif' font-size='14' fill='%23999'%3ENews%3C/text%3E%3C/svg%3E" alt="Îâ¥Ïä§ Ïù¥ÎØ∏ÏßÄ" loading="lazy" />`;
                        html += `<div class="search-result"><div class="result-content"><div class="result-url">${url}</div><div class="result-title"><a href="${item.link}" target="_blank">${item.title}</a></div><div class="result-snippet">${item.snippet}</div><div class="result-time">üïê ${item.time_kst||'N/A'}</div></div>${img}</div>`;
                    });
                    resultsMain.innerHTML = html;
                } else {
                    resultsMain.innerHTML = '<div class="no-results"><h2>Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§</h2></div>';
                }
            } catch (e) {
                resultsMain.innerHTML = `<div class="error">ÏöîÏ≤≠ Ï§ë Ïò§Î•ò: ${e.message}</div>`;
            }
        }
        
        homeSearch.addEventListener('keypress', (e) => e.key === 'Enter' && searchHome());
        headerSearch.addEventListener('keypress', (e) => e.key === 'Enter' && search(headerSearch.value.trim()));
        $('tabs').addEventListener('click', (e) => {
            if (e.target.classList.contains('tab')) {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                e.target.classList.add('active');
            }
        });
    </script>
</body>
</html>
